# # Check out https://docs.codemagic.io/getting-started/building-a-native-ios-app/ for more information
# # Please review and update values in curly braces

workflows:
    ios-app:
        name: iOS App
        environment:
            vars:
                XCODE_WORKSPACE: "ahorta.xcworkspace"  # PUT YOUR WORKSPACE NAME HERE
                XCODE_SCHEME: "ahorta" # PUT THE NAME OF YOUR SCHEME HERE
                APP_STORE_CONNECT_ISSUER_ID: "Encrypted(Z0FBQUFBQmdMWUtmUmxHVVg1VFM4WFdycEw2V1ZlcmhMeG1Yb0FaaE1WZVczRWs2aU9KZU96VU00REZRWTJqV1k4enBHX0RnNDlBTHJ6bkRlV0ZTNGlnUE43X2dibmlmSDNBWnJRSUFGVXNJQWR6TUxsZWlZMElWdElralpwMmIwX0hhYjQwU3lwRjg=)"
                APP_STORE_CONNECT_KEY_IDENTIFIER: "Encrypted(Z0FBQUFBQmdMWU1rSEZ3cjBXLTROYjRqWmVRNmR2ZW84eW52RlhyMWJFelM5bTNmai00TnhFcFVoSm9kbng2U1hNalhwV3JEcEdaZEZGZ0haeVFlUzRrNW5wUHF1MzZDY0E9PQ==)"
                APP_STORE_CONNECT_PRIVATE_KEY: "Encrypted(Z0FBQUFBQmdMb2NzYWk1UUh0cWRhVTdIakVSZ19kckNsTkpBdUJsbkFERVRvbEtoU3VKbmZiWFpyOHVtRGItdWFrSm1CVGxXdFRoUUdiUXpfMUFMSmFUeW45Z2hQNFBiREdqMEVNT2Npc3VWUGQ5M2FXVjlucV9oa294MjBOdDloUDNPNkR4YTNXWXIzSWpWTG9yb29veDlRSFh5UGpzcTZjRGtkMm9LSTIzOFVCYTFjUWFESTh2MmhOaDNtekp6R3FOSjdybmtqMWdpSjBaMTk1X045M0FEeThkZVF0UmtqSVJ4YmFBVnlMOWtJNmdwMmpKc0ZxWTZOcHQzdXU1SHBwd1c5Wnd2c2ZIM2NDcHBTZWZUUnRjRDlYR0psSkRfd0J5NmRkanZrakdkTDBDeEd4QzNCd2IxTnRISFZBdlNheUdHZHBUT2FJYk9ZZFFSYnNlZmNqMS1WUl9WbnFuV3k4bURqcjJ4YnUxb3k5R2MxOU9mNU1EMUV2TThwNzVlalE0Qk5IcnNTQnA1RktXa3AxTHhoRW5NRC1DUHNuUFpNNk9JNUltZ052MjQ5a3dzVFBOVEo1QT0=)"
                CERTIFICATE_PRIVATE_KEY: "Encrypted(Z0FBQUFBQmdMcG9rY2Q5T2lUVlRBWElIQ0tLTWlpMHJ0dnFUWWhaRTRid2VwaFk3SGN1YkYyMGZxM0wwMXFwTmFUa2JUOXZMWF9CdDN5UEUwWURKZ3JPY1Rra3BIVkVWUjFHeWlVLVNUbWZwN1JMUUs2V3pudmJzWHk2QmxkUjN3UGJsV2tZSVVNNFJ4OENzajZwc19fSkM1U3FMSW5Fc21ZRFllZWl1djdnaVdGRDRTYjY3TlFBLV94RW5ET3cwbVk2X3RXNGxETnZfeS1veFlyemhscnFGTHhfUzlnTXYxT054cUZYMnRUNDRzcTlCbzBkbUlxa2lVMlBDRm83Z2JHQlhlaDJndGZma1ZaRnd3NHNZOGR5bzZ6ajJIZ0wwVlFTd24wTjBzb2ZQSFl4RGFuU1E2RE05aFNPWDFLRkFVaVRMQlo2ZmgyQWl5TEkyRURXak1GMGMzLUFXZVdUaS1tMi10emtWb3BnZTNNZzRIanZFN055TUcxNV9DUEZ4Nm5nNFV0eGRETFl2TEVaNURSY3MzVE50WGNzOUlETWpHSHRNeVNwWUhsek5QQXIwQjhUOEt0NWxmUS1kNklRbktRMGdvcHE4MnIxNkRSUmpNdEJiYV95alQ0emRmakt1R0pOVm5JVTJVVy1raDRiVmljNjlwdnYyRjllVGR0VVVwcnRlYmx6dUlZNzZ3ZEw0U3VmQzBHaGk2dzFqV0VETjEtay1zSThuX29aNEdUeG5HNTRHcDNtbWU4WGlZWnIyZXJHQnRyQ3gyY0lDUlhIaUs3dUh0UzItWmkxTTdQR1M1NXg5ZEROa2ZJNW1PMlNIQ0M3dThlZElKY2FVOU1qckxqTHBsYUZiaHp2aUwxMmVJV01ZRE0zNDNBaE9vUTVnQmJnMGlJRWx1eUo3cndRaldVeUI2NnR6STF2VnZQdWNtY1lCelZKUG9XbUczRlUzd3Z2b2w0blVpb0c4WWdmYS01WVVBVVB3U0pmc2NiQkI3ZF9CU1U2SmZldDVXdks3SXkybi0wWUdWbXlDOFhpX3RIejI1ekw4bTRmdlBjLUVESWFaWElmYV9IaDlKWHJ5cEV1bVVsQmgwTEJSZGE4Ymp4bkNmemxZTElRNA==)"
            xcode: latest
            cocoapods: default
        triggering:
            events:
                - push
            branch_patterns:
                - pattern: master
                  include: true
                  source: true
        scripts:
          - name: Set up keychain to be used for codesigning using Codemagic CLI 'keychain' command
            script: keychain initialize
          - name: Fetch signing files
            script: |
                app-store-connect fetch-signing-files "com.ahortacwb.ahorta" --type IOS_APP_DEVELOPMENT --create
          - name: Set up signing certificate
            script: keychain add-certificates
          - name: Set up code signing settings on Xcode project
            script: xcode-project use-profiles
          - name: Build ipa for distribution
            script: xcode-project build-ipa --workspace "$XCODE_WORKSPACE" --scheme "$XCODE_SCHEME"
        artifacts:
          - build/ios/ipa/*.ipa
          - /tmp/xcodebuild_logs/*.log
          - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.dSYM
        publishing:
          app_store_connect:
            apple_id: diwoapple@gmail.com  # PUT YOUR APPLE ID HERE
            password: Encrypted(Z0FBQUFBQmdMamdCcW12WWFraW9wUURWXzVPM0Z3cUxGazJfWXRCMjZhOHJtTmFVMWxELUxuWUNZSGNZNFpHSGhIY3kybWtvdHdqWjRPS3hoRk9Rc181YUpTbUU3aHR4MnhUdTNyV2RqTzJGdW9EbmQzQi1fRDA9) # PUT YOUR APP-SPECIFIC-PASSWORD HERE https://support.apple.com/en-us/HT204397
