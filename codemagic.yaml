# # Check out https://docs.codemagic.io/getting-started/building-a-native-ios-app/ for more information
# # Please review and update values in curly braces

workflows:
    ios-app:
        name: iOS App
        environment:
            vars:
                XCODE_WORKSPACE: "ahorta.xcworkspace"  # PUT YOUR WORKSPACE NAME HERE
                XCODE_SCHEME: "ahorta" # PUT THE NAME OF YOUR SCHEME HERE
                APP_STORE_CONNECT_ISSUER_ID: "Encrypted(Z0FBQUFBQmdMWUtmUmxHVVg1VFM4WFdycEw2V1ZlcmhMeG1Yb0FaaE1WZVczRWs2aU9KZU96VU00REZRWTJqV1k4enBHX0RnNDlBTHJ6bkRlV0ZTNGlnUE43X2dibmlmSDNBWnJRSUFGVXNJQWR6TUxsZWlZMElWdElralpwMmIwX0hhYjQwU3lwRjg=)"
                APP_STORE_CONNECT_KEY_IDENTIFIER: "Encrypted(Z0FBQUFBQmdMWU1rSEZ3cjBXLTROYjRqWmVRNmR2ZW84eW52RlhyMWJFelM5bTNmai00TnhFcFVoSm9kbng2U1hNalhwV3JEcEdaZEZGZ0haeVFlUzRrNW5wUHF1MzZDY0E9PQ==)"
                APP_STORE_CONNECT_PRIVATE_KEY: "Encrypted(Z0FBQUFBQmdMb2NzYWk1UUh0cWRhVTdIakVSZ19kckNsTkpBdUJsbkFERVRvbEtoU3VKbmZiWFpyOHVtRGItdWFrSm1CVGxXdFRoUUdiUXpfMUFMSmFUeW45Z2hQNFBiREdqMEVNT2Npc3VWUGQ5M2FXVjlucV9oa294MjBOdDloUDNPNkR4YTNXWXIzSWpWTG9yb29veDlRSFh5UGpzcTZjRGtkMm9LSTIzOFVCYTFjUWFESTh2MmhOaDNtekp6R3FOSjdybmtqMWdpSjBaMTk1X045M0FEeThkZVF0UmtqSVJ4YmFBVnlMOWtJNmdwMmpKc0ZxWTZOcHQzdXU1SHBwd1c5Wnd2c2ZIM2NDcHBTZWZUUnRjRDlYR0psSkRfd0J5NmRkanZrakdkTDBDeEd4QzNCd2IxTnRISFZBdlNheUdHZHBUT2FJYk9ZZFFSYnNlZmNqMS1WUl9WbnFuV3k4bURqcjJ4YnUxb3k5R2MxOU9mNU1EMUV2TThwNzVlalE0Qk5IcnNTQnA1RktXa3AxTHhoRW5NRC1DUHNuUFpNNk9JNUltZ052MjQ5a3dzVFBOVEo1QT0=)"
                CERTIFICATE_PRIVATE_KEY: "Encrypted(Z0FBQUFBQmdMcDc4cVhmdG9TczlodGp2VFcwb0FYZThxZ0NZZzFGRDZuTFdkdFI2b3I4ZkNlQm5kd3NRcEszX05rLUdwNF9CZHhmeW5XRVI1aEcwaEZjQ0ZSRGc5VnB6Z3RaVVd5OHl1amdCd0pxTV9WRVhkeDVpVTBSQUVZVkhqQmtiZ25hN210QVpmWk90b0dOdDhTbmx1UnBxVW14dkc0bDFXdGZxY1YtZUpObTVfd3ZBcjFGLS1CRnhzS21oa0VrLXEzNmYxSEJzdzI1ZmlQUjZiN0FRdEgwSE1ZY2xsXzdnd19oRm0yZ0QxSFlqMklQbDFZMDhobzZ0bkpLMFlHUDNwRlpmMlhPcl9XN21aNjMzbTQwNkliMWwyd1NlYkVhTVRXRHBod3BaMXFEaWJVcklWYlNxUWVaYXptaDJJQjNyTEVqczMxYk01TkNYdUs2US1GMnlCS0I1aEtGbGd3d1VhellpeTQ2LTBxN0JMcGQyS2poUnRRVWZ4WlhlWDJ1TjJ2U0V2QktnS1NMV3I1NjN4U3kySDliazhyRF81QkctSmZZRGN6X20ySUw3YzVrdUtWLWVoR19MalRWa3FtQnd3RE1icU5PaXBXSktHS0dXWE1aUWNCLWc0RWdLcHB2T2R0bVBPWkZGVWVJa2NUZzl0TmdZZjR5X1U3aERqTlNOMjAtaFRVOW9lU2lFcVZ4Nmp1MjBoTVZISXNaRkpxaG4zZm14UkdZZDFIREtnbEVDUFBSTlUyVko5czg4RGQzSEZib0V6M1NyZTd5aVFsZE85MkU4M1I4bllKYXpqci1ocWQ1eExCTzJrdUNNN243ZVd6cnZwcGc1NUhramxUVUo4cVJoYTZLc3czMnhaQThoT3pSbVFMdVdZM0l3OUJSdkpYc1AxOVFKZkFNcE95TzZsOWVyUDlFTkZIN3U4Z2hLOVl4dU9LTUt4V05hb3dVeG1QRDBvbTRROEdnOC1ObGVNc3A5aVZianBtV2VTeHNPRU5NYnZ4UGJWTEptc3p2dERpcUM1RU9aejgtd2hMRTg2dTluN3NiT2ZWZk5MUTRwT0RVQXFmVDdGRDNBMDM0cVBjV3dBU3BOMG1WWjViMzc4SGk4NWViMVA0S3BOWFpGZF9ZX1JDY1h5SURva2JIMmJNMzB3aEJTQ3NnMDJnNU9LU0JJM3p2YXpJNmswYUp5U2NoSHVTcGEwNDd3a292S00wLTM2NjBxLWlXR1c0SmxuTWlrc0J6SzNvMWZmR2NySlRKcjVnSUl6a3dSRXgzaDdITnZ3a1RqSkN4akY0S19FckZfYV9ET0FjVTZqVzduTnVaRW44enJqc0dBazV1bG9kUW1DZXFMVVdqM1NVeEs5eE1CN1ZUM3dTRUtHbjktdkVDbWl5dkJnbVMtX2c5UGx1THJvdDUtZERhaldybmZEMU9HemRpV21BVjZFRkVSSWNKckgxakV6TlRIb3hsM0NtR3U1NE9xUDZkTkVQbl9ROEJvRGtWZW1aZWhoeDhneE9xbzItYzhCVk8wVlJvS1FOeHFzTlFQU1F3cFQ3cnVuWm1yV19EcHJ1RDV3ckFfRGJGWkRFVmNSd04zbmhiWVRDTEtNN3BxQ3hBcEhySnJBcS1kVERNdVN5c1hHTlI1Y215dnFSeDYxc2xVdjJ0RE9FZGprck1VNlpsSjQ4Rk9obEtzS09NY016YTBBaWNKa0dUTVpQaWIycEZKVmpmLU9KWUFqdTlFalNoZ09mNFNJQlhfNzh4YXAxOHhSNTZDU0I0N2toWTZQb3phX000aEhGUm9lYTI5WFhyVEYtZEdhaUItY1JoTXRkYl9SbTZ2WXgtakxpcllIQldEdnRwbGtfRnBGNVpVcDE0RXNnQkV4U2J2RGJJa3JrMXJZT1FWaEJGeHlkSENYMVVsOHI5bExDNENWWkpiSUU4TlZCZl9JUXVjZjF0bWZsT3BMVWdjb1Q1bGlfaGFVX01obEItWUNvVThDa2lUZU1qWmNKVVNsRi1fWHFBN0VJQy1JWExHb2RjdHcyenVKdnBxb3JWSXRsdmh6aTRaV2FFOEFlQ2U5Y283dkFPN3FvUHUzYnA1VndQc0o2Sk5xWkdqakdOUFQ2akJ3MFRjV1A5SWU0UEdNMnNNc0xaMkRST3lDQ1hmSzZFQXJpUDBIRk01YTFfOTVLN1RTOEhMcUNnSDhadm5MU1A5OUdHYm5wbmRjS1EySEgwcmZTT2VpUkphcDd0Y3dRTDV2dXNMdV9pZWwwOVp5NXZONWZwQTM3dEZFUUVzZ0J5QTlmdC1oVHV1Sm43YkQycFpVUk45RXBVYXp5Q05CSGQ4WDg3em9scURweVJYclQxbFB4Mm01UExpZUYxOTY1MlRFRTdsR1djcVU2YTNkWFdyNGUyNENVeEdlc2R2a04xa0lCWnJGWnRYMmkyS1loZGYtRHpBUGRpM1BmSVRTVGx4RGd0enpITFhvaXVwTnZNeW1iV0lTbDV4NzdSNjgwSWFYM05CZ2xHbE0zUEJDYkY4WkVUcHFHR3JVNWx6eHF6dkJ3QzZjcmI2LTR1dzB6MDctZ1FFbE1wSmRCU0VTQXk1SUdWRmM3eGZ5R1A3RDliMV9hMnlvR2dMS1NRek5sLVpQQjVUc0gtY3VnMTZ0aFV0UUVfUmpCbGI1cjZfTWZNYWtQMWJ3SURnakMzN204SjUxZlVVRjc5aUo0Rzk2UjIyZ0hoOVAtMDRtVHJUNXdYekNMczRDZUtxZzJQeHVTMWw2YkFKbVN2b2ZaVm5qYTYzNWt1X0NWSUFjMGkxZ0U5NFFwbXZNOUFITWlMcEc4d1ZpUHZ6Wjl2bFJoM0J3UWkwWUxHZnNZTUtyT3NsaHhib0pqTm9VWjNqazY1V1VoV2hPcnc0V09Wdlg0c25ZeV9FT0VUVHdNdDdhX09NcXZJdTduaGtoWUZoN25OTkdpQkNXcno4Q1pmTlZZb3RNM3VqSlYtTzNycVlWSXF0VkRqcVdlOEdPS3RLUExwVVBUdHVTN2RpOUlQV0llNlY4M1A0THZiSlFjSWhySEF0d3RTNzBtelhPaFdPZm11M1RhemZHRy1BazgxVjl0cnI4NVNtQ0QyWGpKbERaWEtnTHhBVDBiT0dUZEUzYUV1dHNCSk01VlpRNFpKbk1tQm9ZZ3RrY0ktUUhmYkVDNXJnUEJYQUdhTGZybFNzaUpzWnVTR3lnOF9wUGx5bmpCR2RqeUg4RUdtZ2VxaGN3eHV6eHdXYTJ3QmhodThpbVJKNnNCT3dDcUpaME5jTzRPdnJQVUpMdXRERWhEd2x4R2xQdFIzTGNzMjhnUFAxRWNnOFpBQ1dOS2ZueDlkOUFaSEVtbmRUYVhhQzU4cmJOWGl6Z1BBYnc0ZEd2dEd1TFEzbHV4RT0=)"
            xcode: latest
            cocoapods: default
        triggering:
            events:
                - push
            branch_patterns:
                - pattern: master
                  include: true
                  source: true
        scripts:
          - name: Set up keychain to be used for codesigning using Codemagic CLI 'keychain' command
            script: keychain initialize
          - name: Fetch signing files
            script: |
                app-store-connect fetch-signing-files "com.ahortacwb.ahorta" --type IOS_APP_DEVELOPMENT --create
          - name: Set up signing certificate
            script: keychain add-certificates
          - name: Set up code signing settings on Xcode project
            script: xcode-project use-profiles
          - name: Build ipa for distribution
            script:  xcode-project build-ipa --project "ahorta.xcodeproj" --scheme "ahorta"
        artifacts:
          - build/ios/ipa/*.ipa
          - /tmp/xcodebuild_logs/*.log
          - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.dSYM
        publishing:
          app_store_connect:
            apple_id: diwoapple@gmail.com  # PUT YOUR APPLE ID HERE
            password: Encrypted(Z0FBQUFBQmdMamdCcW12WWFraW9wUURWXzVPM0Z3cUxGazJfWXRCMjZhOHJtTmFVMWxELUxuWUNZSGNZNFpHSGhIY3kybWtvdHdqWjRPS3hoRk9Rc181YUpTbUU3aHR4MnhUdTNyV2RqTzJGdW9EbmQzQi1fRDA9) # PUT YOUR APP-SPECIFIC-PASSWORD HERE https://support.apple.com/en-us/HT204397
